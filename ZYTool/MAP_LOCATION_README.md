# 地图定位工具使用说明

## 功能概述

地图定位工具可以获取用户当前的地理位置，并在高德地图上显示位置标记和精度范围。

## 访问地址

```
http://localhost:5173/tools/map
```

## 主要功能

### 1. 获取当前位置
- 点击"获取当前位置"按钮
- 浏览器会请求位置权限（首次使用需要授权）
- 获取成功后显示经纬度、精度等信息

### 2. 地图显示
- 在高德地图上显示当前位置标记
- 蓝色圆圈表示定位精度范围
- 自动获取并显示详细地址信息

### 3. 位置信息
显示的信息包括：
- **经度**：东西方向的坐标
- **纬度**：南北方向的坐标
- **精度**：定位的准确度（米）
- **获取时间**：定位的时间戳
- **地址信息**：通过逆地理编码获取的详细地址

### 4. 快捷操作
- 每个坐标值旁边都有"复制"按钮，方便快速复制经纬度

## 使用要求

### 浏览器权限
- 首次使用时，浏览器会弹出位置权限请求
- 需要点击"允许"才能使用定位功能
- 如果拒绝了权限，可以在浏览器设置中重新开启

### 网络环境
- **HTTPS环境**：定位更准确，功能完整
- **HTTP环境**：部分浏览器可能限制定位功能
- 需要网络连接来加载地图和获取地址信息

### 浏览器支持
支持所有现代浏览器：
- Chrome/Edge（推荐）
- Firefox
- Safari
- Opera

## 定位精度说明

定位精度受多种因素影响：

1. **设备类型**
   - 手机/平板：通常10-50米
   - 笔记本电脑：通常50-100米
   - 台式机：可能较低

2. **定位方式**
   - GPS定位：精度最高（5-20米）
   - WiFi定位：精度中等（20-100米）
   - IP定位：精度较低（可能数公里）

3. **环境因素**
   - 室外开阔地：精度高
   - 室内/高楼密集区：精度降低
   - 天气状况也会影响GPS精度

## 高德地图API配置

### 获取API Key

1. 访问高德开放平台：https://lbs.amap.com/
2. 注册并登录账号
3. 进入"应用管理" → "我的应用"
4. 创建新应用，添加Key
5. 选择"Web端(JS API)"类型

### 配置API Key

在 `MapLocationView.vue` 文件中找到以下代码：

```javascript
script.src = 'https://webapi.amap.com/maps?v=2.0&key=YOUR_AMAP_KEY'
```

将 `YOUR_AMAP_KEY` 替换为你的实际API Key。

### 免费额度

高德地图提供免费配额：
- 每日调用量：30万次
- 并发量：300次/秒
- 对于个人项目和小型应用完全够用

## 常见问题

### 1. 定位失败
**可能原因：**
- 用户拒绝了位置权限
- 浏览器不支持地理定位API
- 网络连接问题

**解决方法：**
- 检查浏览器权限设置
- 使用支持的浏览器
- 检查网络连接

### 2. 地图不显示
**可能原因：**
- 高德地图API Key未配置或无效
- 网络连接问题
- API调用超出配额

**解决方法：**
- 配置正确的API Key
- 检查网络连接
- 查看浏览器控制台错误信息

### 3. 定位不准确
**可能原因：**
- 设备GPS信号弱
- 使用WiFi或IP定位
- 室内环境

**解决方法：**
- 移动到室外开阔地
- 等待GPS信号稳定
- 多次定位取平均值

## 技术实现

### 使用的技术
- **Geolocation API**：浏览器原生定位API
- **高德地图 JS API 2.0**：地图显示和地理编码
- **Vue 3 + TypeScript**：前端框架
- **Ant Design Vue**：UI组件库

### 核心代码

```typescript
// 获取当前位置
navigator.geolocation.getCurrentPosition(
    (position) => {
        const { longitude, latitude, accuracy } = position.coords
        // 处理位置信息
    },
    (error) => {
        // 处理错误
    },
    {
        enableHighAccuracy: true, // 启用高精度
        timeout: 10000,           // 超时时间
        maximumAge: 0             // 不使用缓存
    }
)
```

## 隐私说明

- 位置信息仅在浏览器本地处理
- 不会上传到服务器
- 仅用于地图显示和地址解析
- 用户可以随时拒绝位置权限

## 未来改进

可能的功能扩展：
- [ ] 支持地址搜索定位
- [ ] 保存常用位置
- [ ] 计算两点间距离
- [ ] 路线规划
- [ ] 支持多种地图（百度、腾讯等）
- [ ] 导出位置信息为多种格式

## 相关链接

- [高德开放平台](https://lbs.amap.com/)
- [高德地图 JS API 文档](https://lbs.amap.com/api/javascript-api/summary)
- [Geolocation API 文档](https://developer.mozilla.org/zh-CN/docs/Web/API/Geolocation_API)
